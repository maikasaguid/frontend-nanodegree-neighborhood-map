"use strict";function Location(a,b,c,d){var e=this;e.ll=b+","+c,e.name=a,e.lat=b,e.lng=c,e.marker=new google.maps.Marker({icon:{scaledSize:new google.maps.Size(54,27),url:"images/icon.svg"},map:map,position:new google.maps.LatLng(b,c),title:a}),e.show=ko.observable(d),e.hours=ko.observable("No hours found."),e.phone=ko.observable("No phone number found."),e.rating=ko.observable("No rating found."),e.address=ko.observable("No address found."),e.foursquare=ko.observable(!1),e.fsFail=ko.observable(!1),e.infoMarker=ko.computed(function(){return e.foursquare()?"<h1>"+e.name+"</h1>"+e.phone()+"<br />"+e.address().address+"<br />"+e.address().city+", "+e.address().state+"<br />"+e.hours()+"<br />Foursquare Rating: "+e.rating():"<h1>"+e.name+"</h1>Unable to load Foursquare data."},e),e.infoList=ko.computed(function(){return e.foursquare()?e.phone()+"<br />"+e.address().address+"<br />"+e.address().city+", "+e.address().state+"<br />"+e.hours()+"<br />Foursquare Rating: "+e.rating():e.fsFail()?"Unable to load Foursquare data.":"Loading Foursquare data..."},e),google.maps.event.addListener(e.marker,"click",function(){var a=foursquareAPI+"&ll="+e.ll+"&llAcc=100&query=pizza&limit=1";mapCenter=e.marker.getPosition(),map.setCenter(mapCenter),infoWindow.setContent(""),$.getJSON(a).done(function(a){e.foursquare(!0),e.rating(a.response.groups[0].items[0].venue.rating),e.phone(a.response.groups[0].items[0].venue.contact.formattedPhone),e.hours(a.response.groups[0].items[0].venue.hours.status),e.address(a.response.groups[0].items[0].venue.location),infoWindow.setContent(e.infoMarker())}).fail(function(){e.foursquare(!1),infoWindow.setContent("<h1>"+e.name+"</h1>Unable to load Foursquare data.")}),infoWindow.open(map,this)})}function convertToLocations(a){for(var b=[],c=0;c<a.length;c++)b[c]=new Location(a[c].name,a[c].lat,a[c].lng,!0);return b}function AppViewModel(){var a=this;a.currentList=ourTopPizza,a.currentListString="our",a.filter=ko.observable(""),a.fsFail=ko.observable(!1),a.locations=ko.observableArray(convertToLocations(a.currentList)),a.choosePizzaList=function(b,c){c.target.id!=a.currentListString&&(a.currentListString=c.target.id,ko.utils.arrayForEach(a.locations(),function(a){a.marker.setMap(null)}),a.locations([]),"yelp"===c.target.id&&(a.currentList=yelpTopPizza),"our"===c.target.id&&(a.currentList=ourTopPizza),"all"===c.target.id,a.locations(convertToLocations(a.currentList)),a.filterListMap())},a.getAPIData=function(a){if(0==a.foursquare()){var b=foursquareAPI+"&ll="+a.ll+"&llAcc=100&query=pizza&limit=1";$.getJSON(b).done(function(b){var c=b.response.groups[0].items[0].venue.rating,d=b.response.groups[0].items[0].venue.contact.formattedPhone,e=b.response.groups[0].items[0].venue.hours.status,f=b.response.groups[0].items[0].venue.location;a.foursquare(!0),a.fsFail(!1),"undefined"!=typeof c&&a.rating(c),"undefined"!=typeof d&&a.phone(d),"undefined"!=typeof e&&a.hours(e),"undefined"!=typeof f&&a.address(f)}).fail(function(){a.foursquare(!1),a.fsFail(!0)})}},a.filterListMap=function(){ko.utils.arrayForEach(a.locations(),function(b){b.show(!0),b.marker.setMap(map),-1==b.name.toLowerCase().indexOf(a.filter().toLowerCase())&&(b.show(!1),b.marker.setMap(null))})}}var foursquareAPI="https://api.foursquare.com/v2/venues/explore?oauth_token=VFBZKAJP32E521Y2JXBQ05NBY4ZYQZMDSZBUL4N0IA0UJ5O1&v=20150511",minZoomLevel=11,lat=21.49,lng=-158.035,hnlLat=21.3,hnlLng=-157.858,iconBase="http://maps.google.com/mapfiles/kml/pal2/",icons={bar:{icon:iconBase+"icon27.png"},cafe:{icon:iconBase+"icon62.png"},food:{icon:iconBase+"icon47.png"},meal_delivery:{icon:iconBase+"icon47.png"},meal_takeaway:{icon:iconBase+"icon47.png"},restaurant:{icon:iconBase+"icon63.png"}},map=new google.maps.Map(document.getElementById("map"),{center:{lat:lat,lng:lng},mapTypeControl:!1,panControl:!1,streetViewControl:!1,zoom:minZoomLevel,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER}}),infoWindow=new google.maps.InfoWindow,service=new google.maps.places.PlacesService(map);google.maps.event.addListener(map,"zoom_changed",function(){map.getZoom()<minZoomLevel&&map.setZoom(minZoomLevel)});var mapCenter=map.getCenter();google.maps.event.addDomListener(window,"resize",function(){map.setCenter(mapCenter)});var ourTopPizza=[{name:"Big Kahuna's Pizza",lat:21.335522,lng:-157.91654500000004},{name:"J.J. Dolan's",lat:21.310943,lng:-157.860536},{name:"Bravo Restaurant",lat:21.383593,lng:-157.94557099999997},{name:"Rosarina Pizza",lat:21.31229,lng:-157.862618},{name:"Doughlicious",lat:21.294302,lng:-157.841133},{name:"La Pizza Rina",lat:21.298095,lng:-157.83961599999998},{name:"Brick Oven Pizza",lat:21.332582,lng:-158.082038},{name:"Pizza Corner",lat:21.342423,lng:-158.124125},{name:"Serino's Pizza",lat:21.308459,lng:-157.810562},{name:"Boston's North End Pizza Restaurant",lat:21.380137,lng:-157.93820600000004}],yelpTopPizza=[{name:"Hiking Hawaii Cafe",lat:21.285458,lng:-157.835197},{name:"Kaneohe's Boston Pizza",lat:21.41895,lng:-157.804038},{name:"Amina Pizzeria",lat:21.292439,lng:-157.836421},{name:"JJ Dolan's",lat:21.310943,lng:-157.860536},{name:"The Lovin' Oven",lat:21.276885,lng:-157.823936},{name:"Uncle Bo's Pupu Bar & Grill",lat:21.27774,lng:-157.813856},{name:"Marketplace Cafe",lat:21.292547,lng:-157.84196},{name:"Impossibles Pizza",lat:21.664547,lng:-158.050516},{name:"Arancino on Beachwalk",lat:21.280135,lng:-157.83089},{name:"Fendu Boulangrie",lat:21.307802,lng:-157.81046}];ko.applyBindings(new AppViewModel),$(document).ready(function(){$(".main .list").hide().click(function(a){a.preventDefault()}),$(".well label").click(function(){("mapView"==$(this).attr("for")||"mapView2"==$(this).attr("for"))&&($(".main .list").hide(),$("#map").show()),("listView"==$(this).attr("for")||"listView2"==$(this).attr("for"))&&($("#map").hide(),$(".main .list").show())}),$(".nav-sidebar").children("li").click(function(){$(".nav-sidebar").children("li").removeClass("active"),$(this).addClass("active")}),$(".nav-list").children("li").click(function(){$(".nav-list").children("li").removeClass("active"),$(this).addClass("active")})});